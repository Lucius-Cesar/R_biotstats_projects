{
    "collab_server" : "",
    "contents" : "---\ntitle: \"Croissance d'espèces d'_Iris_\"\nsubtitle: \"Différence de la longueur des pétales sur 3 espèces d'_Iris_ :  _I. setosa_, _I. versicolor_, _I. verginica_\"\nauthor:\n  - name: \"Engels Guyliann\"\n    email: \"guyliann.engels@umons.ac.be\"\n    affiliation: \"Université de Mons - Service d'écologie numérique des milieux aquatiques, Plaine de Nimy, Pentagone, 3ième étage, Aile D\"\ndate: \"30 octobre 2017\"\nabstract: \"Les travaux pratiques de biostatistiques et probabilités ont pour objectif de former les étudiants à l'utilisation des biostatistiques et l'utilisation des programmes R et R Studio. Ce rapport a pour but d'illustrer les principales attentes lors de la rédaction d'un rapport portant sur l'analyse de variance. \"\nbibliography: ../bibliographie/biblio3.bib\noutput:\n  html_notebook:\n    fig_caption: yes\n    highlight: zenburn\n    number_sections: yes\n    toc: yes\n    toc_depth: 4\n---\n\n\n# Introduction\n\nAnderson [-@Anderson1935] s'est intéressé à la distribution géographique de 3 espèces [@Fisher1936] de  monocotylédones, appartenant à la famille des _Iridaceae_ que sont _Iris setosa_ L. (1753), _Iris versicolor_ Pall. (1820) et _Iris verginica_ L. (1753).\n\n\n![Photographie d'iris versicolore](../image/iris_versicolore.jpg)\n\n\nLes observations biométrique d'Anderson vont être employées par Fischer [-@Fisher1936] dans des analyses multivariées et devenir un jeu de données très employé. Le données collectée par Anderson vont être réutilisé pour illuster de nombreuse analyses jusqu'à nos jours [@Runkler2012].\n\nCes trois espèces pérennes sont native d'Amérique du Nord (PlantsDatabse, USDA, mise à jour 23/10/2017)\n\n# But\n\nCette analyse souhaite montrer la différence de longueurs des pétales sur les 3 espèces d'*Iris* que sont  _I. setosa_, _I. versicolor_, _I. verginica_ . \n\n\n# Matériels et méthodes\n\n## Acquisition des données\n\n\nAnderson [-@Anderson1935] a mesuré la longueur et la largeur de pétales et de sépales sur 50 individus d' _I. setosa_, d' _I. versicolor_, d' _I. verginica_ présent en Gaspésie (48°39′29″N,65°45′10″W). \n\n```{r}\nlibrary(tidyverse)\nlibrary(cowplot)\n#?map_data()\nworld <- map_data(\"world\")\nworld$region <- as.factor(world$region)\nworld$subregion <- as.factor(world$subregion)\ncanada <- filter(world, region == \"Canada\")\n\nggplot(data = canada) +\n  geom_polygon(mapping = aes(long, lat, group = group), fill= \"white\", color = \"black\")  +\n  geom_point(aes(y = 48.658056 , x = -65.752778 , color = \"#CD0000\"), size = 2, show.legend = FALSE)+theme(plot.caption = element_text(hjust = 0.5), axis.line = element_blank(), axis.title = element_blank(),axis.text = element_blank(), axis.ticks = element_blank()) +\n  coord_quickmap() +\n  labs( caption = \"Carte du Canada avec la mise en évidence \\n du site de l'étude (Gaspésie, Québec, Canada)\")\n```\n\n\n## Analyse des données\n\nLe test d'hypothèse employé afin de comparer la longueur des pétales des trois espèces d'*Iris* est une analyse de la variance à un facteur.\n\nL'ANOVA a un facteur à pour hypothèse : \n\n$H_{0}$ : $\\mu_{1} =  \\mu_{2} =  ... = \\mu _{p}$\n\n$H_{1}$  :  au moins une moyenne est différente\n\nLe seuil $\\alpha$ des différents tests d'hypothèses est fixé pour l'ensemble des analyses à 0.05. Ce test requiert le respect de différentes conditions d'applications que sont :\n\n* échantillon aléatoire\n\n* observations indépendantes\n\n* distribution normale des résidus\n\n* homoscédasticité (même variance intragroupes)\n\nNous supponsons que les deux premières conditions sont respectées et nous vérifierons les deux dernières. \n\nLa distribution des résidus est visualisé avec un graphique quantile-quantile comparant la distribution de ces résidus avec une distribution normale. L'homoscédasticité est testée avec le test de Bartlett qui a pour hypothèse : \n\n$H_{0}$ : Homoscédasticité : $var_{1} = var_{2} = ... = var_{p}$\n\n$H_{1}$  :  Hétéroscédasticité : au moins une variance est différente\n\nUne comparaison multiple de Tukey est enfin employé pour comparer deux à deux les 3 espèces d'Iris, qui est une succession de test de student adapté à l'anova. \n\n# Résultats\n\n```{r}\n# Je charge mon jeu de données présent dans le dossier data, il s'agit du jeu de données IRIS que tous les utilisateurs de R ont eu l'occasion d'utiliser. Ce dernier a été sauvegardé en fichier CSV.\n\nlibrary(readr)\niris <- read_csv(\"../data/iris.csv\", \n    col_types = cols(X1 = col_skip()))\n#Je visualise les données avec la fonction head\n#head(iris, n = 5)\n\n# Je vérifie dans l'environnement global que mes données sont importées dans le format souhaité :  Sepal.Length, Sepal.Width, Petal.Length, Petal.Width sont exprimés en variables numériques et Species est exprimé en variable caractères.\n#je modifie les données pour obtenir une variables facteurs avec les addins\n\n## Recoding iris$Species\niris$Species <- as.character(iris$Species)\niris$Species <- factor(iris$Species)\n\n#facteur à 3 niveaux. Je sais d plus qu'il y a 150 observations et 5 variables\n# la fonction levels me permet de prendre connaissance des niveaux facilement : \n#levels(iris$Species)\n## nous avons donc : \"setosa\"     \"versicolor\" \"virginica\" \n\n# après avoir pris connaissance des données, on utilse la dièse pour ne plus effectuer les instructions de découvertes\n\n```\n\n## La longueur des pétales \n\n### Statistiques descriptives \n \n#### Statistiques descriptives numériques \n\nLa moyenne des pétales semble montrer une différence entre Iris Setosa ($1.46\\pm0.17 mm$),  Iris versicolor ($4.26\\pm0.47mm$) et Iris verginica ($5.55\\pm0.55mm$). \n\n```{r}\n# Je charge le package dplyr\nlibrary(dplyr)\n\n# Je souhaite faire un nouveau tableau résumant mes données en tenant compte des trois espèces, pour ce faire je groupe par espèce.\n\niris%>%group_by(Species)%>% summarise(\"mean\" = mean(Petal.Length), \"sd\" = sd(Petal.Length), \"number\" = length(Petal.Length)) -> a\n## La manière d'écrire ce code est expliqué en détails dans le livre R for Data science :  http://r4ds.had.co.nz/\n## Décomposons cependant le code, notre jeu de données iris va être groupé par les especes (Species), dont on veut un résumé ( summarise) avec la moyenne (mean), l'écart-type(sd) et le nombre d'observations (length). On assigne ce tableau de données à la lettre a \n\nlibrary(knitr)\n# La tableau de base ne me convenait pas, les titres de mes colonnes étaient en anglais, mon tableau n'avait pas de titre, ... je fais appel à l'aide ?kable()\nkable(x = a, format = \"pandoc\", caption = \"Tableau des longueurs moyennes (en mm) des pétals de trois espèces d'*Iris* : _I. setosa_, _I. versicolor_, _I. verginica_\", col.names = c(\"Especes\", \"Longeur moyenne\", \"Ecart-type\", \"Nombre d'observations\"), align = \"c\")\n## x = a , c'est le nom de mon tableau résumé calculé dans la partie supérieur du chunk\n## format = \"html\" , c'est le type de tableau que je veux. Notre fichier est en HTML de ce fait, je demande un HTML\n## caption = \" \", c'est le titre du tableau\n## col.names = \" \", c'est le nom des colonnes\n## align = \"c\", je souhaite que les lignes du tableau soit centrer\n```\n\n\n#### Statistiques descriptives graphiques\n\nLa boite à moustache apporte une information visuelle sur les 5 nombres que sont la valeur minimale, le premier quartile, la mediane, le troisième quartile et la valeur maximale par espèce. Tout comme les valeurs numériques semble montrer, on observe que _I. setosa_ semble bien distinct de deux autres espèces.\n\n```{r}\n# je souhaite utiliser un outil graphique permettant de montrer la variation de la longueur des pétales en fonction de mes 3 espèces d'Iris. Il s'agit donc d'une variable numérique (quantitative continu ) avec une variable facteur (variable qualitative non-ordonnée)\n\n#J appelle le package lié aux graphiques utilisant ggplot2\nlibrary(tidyverse)\n\n\na <- ggplot(data = iris) + # je souhaite un graphique dont le jeu de données s'appelle iris, + ...\n  geom_boxplot(mapping = aes(x = Species, y = Petal.Length)) # Je souhaite un boxplot dont les données seront réparties en x avec les espèces et en y selon la longueur des pétales. \n# a \n# Ce graphique trop simple ne me convient pas, il lui manque une légende, des axes en français, un peu de couleurs,... Je vais donc l'améliorer \n\n\nggplot(data = iris)+\n  geom_boxplot(mapping = aes(x = Species, y = Petal.Length), fill = c(\"#27408B\", \"#EE9A00\", \"#CD0000\"))+ # le choix des couleurs a été fait avec l'addins : colour picker \n  theme_classic() + # dans les aides mémoire de ggplot2, on peut trouver dans la partie theme, comment changer le fond gros par défaut\n  labs( x = \"Espèces\", y = \"Longueur des pétales\", caption = expression(paste(\"Boite à moustache de la variation de la longueur d' \", italic(\" I. setosa, d' I. versicolor, d'I. verginica \"), \".\")))+ # utilisation de la fonction expression et paste pour permettre d'avoir le nom des espèces en italique \n  theme(plot.caption = element_text(hjust = 0.5, size = 10)) # Je souhaite centrer la légende de mon graphique.\n```\n\n\n### Statistiques\n\n```{r}\n#les test d'hypothèse permettant de comparer une variable quantitative par rapport à une variable qualitative à plus de 2 niveaux est l'ANOVA ou bien la version non paramétrique\n\n# Parmi les conditions d'utilisation de ce test d'hypothèse, il faut que les résidus respectent une distribution normal \niris %>% mutate(Petal.Length.res = Petal.Length - ave(Petal.Length, Species)) -> iris\nlibrary(car)\nqqPlot(iris$Petal.Length.res, distribution = \"norm\", envelope = 0.95, col = \"Black\", ylab = \"Résidus des longueurs des pétales\", xlab = \"Quantiles de la distribution normale\")\n\n\n#la distribution des résidus par rapport à une distribution noraml acceptant une enveloppe de confiance montre que certains poitns sortent de cette enveloppe de confiance. le test de Bartlett montre qu'il y a hétéroscédasticité des variables. tentons une transformation des données\n```\n\nNous observons que la distribution des résidus des longueurs suit une distribution normale avec un interval de confiance de 95%, à l'exception de quelques points.\n\n```{r}\nbartlett.test(Petal.Length  ~ Species, data = iris)\n```\n\n\nIl y a hétéroscédasticité des variances au seuil $\\alpha$ de 0.05 (test de Bartlett, k^2^ = 55.423, p = 9.229e-13). \n\n\n## Le logarithme des longueurs\n\n```{r}\niris %>% mutate(log_pl = log(Petal.Length)) -> iris\n```\n\n### Statistiques descriptives \n \n#### Statistiques descriptives numériques \n\nLe logarithme des moyennes des pétales semble indiquer une différence entre Iris Setosa ($0.37\\pm0.12$) par rapport aux deux autres espèces que sont Iris versicolor ($1.44\\pm0.11$) et Iris verginica ($1.71\\pm0.09$).\n\n```{r}\niris%>%group_by(Species)%>% summarise(\"mean\" = mean(log_pl), \"sd\" = sd(log_pl), \"number\" = length(log_pl)) -> a\nlibrary(knitr)\nkable(x = a, format = \"pandoc\", caption = \"Tableau des logarithmes moyens des longueurs des pétales de trois espèces d'*Iris* : _I. setosa_, _I. versicolor_, _I. verginica_\", col.names = c(\"Especes\", \"logarithme moyen des Longeurs\", \"Ecart-type\", \"Nombre d'observations\"), align = \"c\")\n```\n\n\n#### Statistiques descriptives graphiques\n\nLa boite à moustache apporte une information visuelle qui semble indiquer, tout comme les valeurs moyennes qu' _I. setosa_ semble bien distinct de deux autres.\n\n```{r}\n\nggplot(data = iris)+\n  geom_boxplot(mapping = aes(x = Species, y = Petal.Length), fill = c(\"#27408B\", \"#EE9A00\", \"#CD0000\"))+ \n  theme_classic() + \n  labs( x = \"Espèces\", y = \"Logarithme des longueurs des pétales\", caption = expression(paste(\"Boite à moustache de la variation \\n du logarithme des longueurs de pétales d' \", italic(\" I. setosa, d' I. versicolor, d'I. verginica \"), \".\")))+\n  theme(plot.caption = element_text(hjust = 0.5, size = 10))\n```\n\n### Statistiques\n\n```{r}\nlibrary(dplyr)\niris %>% mutate(log_pl_res = log_pl - ave(log_pl, Species)) -> iris\nlibrary(car)\nqqPlot(iris$log_pl_res, distribution = \"norm\",\n            envelope = 0.95, col = \"Black\", ylab = \"Résidus des logarithmes des longueurs des pétales\", xlab = \"Quantiles de la distribution normale\")\n\n```\n\nNous observons que la distribution des résidus des logarithmes des longueurs suit une distribution normale avec un interval de confiance de 95%, à l'exception d'un point.\n\n```{r}\nbartlett.test(log_pl  ~ Species, data = iris)\n```\n\nDe plus, il y a homoscédasticité des variances au seuil $\\alpha$ de 0.05 (test de Bartlett, k^2^ = 2.3295, p = 0.312)\n\n```{r}\nanova(anova. <- lm(log_pl ~ Species, data = iris))\n```\n\nL'analyse de variances indique qu'au moins une des moyennes des logarithmes des longueurs des pétales des trois espèces d'iris est significativement différente au seuil $\\alpha$ de 0.05 (ANOVA, F = 1999.9, p = < 2.2e-16).\n\n```{r}\nsummary(anovaComp. <- confint(multcomp::glht(anova.,\n  linfct = multcomp::mcp(Species = \"Tukey\")))) # Add a second factor if you want\n.oma <- par(oma = c(0, 5.1, 0, 0)); plot(anovaComp.); par(.oma); rm(.oma)\n```\n\nLe graphique de comparaisons multiples basé sur le test de Tukey est alors employé pour completer l'analyse de la variance. Il indique qu'il y a une différence hautement significative entre chacune des espèces d'Iris au seuil $\\alpha$ de 0.05. \n\n# Discussion \n\nL'analyse de la variance des longueurs des trois espèces ne peut se faire sans transformer les données. En effet, la condition de validité du test touchant à l'homogénéité de la variance (homoscédasticité) n'est pas respectée. Pour pallier à ce non-respect des conditions de validité, la transformation par le logarithme népérien est employé. L'analyse de la variance suivi d'un test de comparaisons multiples de Tukey indique qu' *Iris setosa*  avec une valeur du moyenne du logarithme de $0.37\\pm0.12$ , qu'*Iris versicolor* avec $1.44\\pm0.11$ et qu' *Iris virginica* avec $1.71\\pm0.09$ sont significativement différents les unes des autres. \n\n\n# Conclusion\n\nEn conclusion, le logarithme des longueurs d' *Iris setosa* d' *Iris versicolor* et d' *Iris virginica* est significativement différent. L'utilisation de la biométrie des pétales est un bon paramètres pour distinguer les 3 espèces. \n\n\n# Bibliographies\n\n\n\n",
    "created" : 1509373766908.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1938479551",
    "id" : "EC6B5F89",
    "lastKnownWriteTime" : 1509187274,
    "last_content_update" : 1509380157395,
    "path" : "T:/Biostat/Ba2/R/iris/rapports/iris_engels.Rmd",
    "project_path" : null,
    "properties" : {
        "chunk_output_type" : "inline"
    },
    "relative_order" : 2,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}